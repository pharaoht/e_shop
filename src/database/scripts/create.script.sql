CREATE TABLE Genders (
    GenderID INT PRIMARY KEY AUTO_INCREMENT,
    GenderName VARCHAR(255) NOT NULL
);

CREATE TABLE Categories (
    CategoryID INT PRIMARY KEY AUTO_INCREMENT,
    CategoryName VARCHAR(255) NOT NULL,
    GenderID INT NOT NULL,
    FOREIGN KEY (GenderID) REFERENCES Genders(GenderID) ON DELETE CASCADE
);

CREATE TABLE Subcategories (
    SubcategoryID INT PRIMARY KEY AUTO_INCREMENT,
    SubcategoryName VARCHAR(255) NOT NULL,
    CategoryID INT NOT NULL,
    GenderID INT NOT NULL,
    FOREIGN KEY (CategoryID) REFERENCES Categories(CategoryID) ON DELETE CASCADE,
    FOREIGN KEY (GenderID) REFERENCES Genders(GenderID) ON DELETE CASCADE
);

CREATE TABLE Materials (
    MaterialID INT PRIMARY KEY AUTO_INCREMENT,
    MaterialName VARCHAR(255) NOT NULL
);

CREATE TABLE Colors (
    ColorID INT PRIMARY KEY AUTO_INCREMENT,
    ColorName VARCHAR(255) NOT NULL,
    ColorCode VARCHAR(255) NOT NULL
);

CREATE TABLE Products (
    ProductID INT PRIMARY KEY AUTO_INCREMENT,
    ProductName VARCHAR(255) NOT NULL,
    CategoryID INT,
    SubcategoryID INT,
    MaterialID INT,
    GenderID INT,
    Price DECIMAL(10, 2) NOT NULL,
    Description TEXT,
    OnSale BOOLEAN DEFAULT FALSE,
    SalePrice DECIMAL(10, 2),
    IsClearance BOOLEAN DEFAULT 
    CreatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UpdatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP;
    FOREIGN KEY (GenderID) REFERENCES Genders(GenderID) ON DELETE SET NULL,
    FOREIGN KEY (MaterialID) REFERENCES Materials(MaterialID) ON DELETE SET NULL,
    FOREIGN KEY (SubcategoryID) REFERENCES Subcategories(SubcategoryID) ON DELETE SET NULL,
    FOREIGN KEY (CategoryID) REFERENCES Categories(CategoryID) ON DELETE SET NULL,
);

CREATE TABLE ProductColors (
    ProductColorID INT PRIMARY KEY AUTO_INCREMENT,
    ProductID INT NOT NULL,
    ColorID INT NOT NULL,
    FOREIGN KEY (ProductID) REFERENCES Products(ProductID) ON DELETE CASCADE,
    FOREIGN KEY (ColorID) REFERENCES Colors(ColorID) ON DELETE CASCADE
);

CREATE TABLE Sizes (
    SizeID INT PRIMARY KEY AUTO_INCREMENT,
    SizeName VARCHAR(50) NOT NULL  -- e.g., "S", "M", "L", "XL"
);

CREATE TABLE Images (
    ImageID INT PRIMARY KEY AUTO_INCREMENT,
    ProductID INT,
    ImageURL VARCHAR(255) NOT NULL,
    FOREIGN KEY (ProductID) REFERENCES Products(ProductID) ON DELETE CASCADE
);


CREATE TABLE Users (
    ID INT PRIMARY KEY AUTO_INCREMENT,
    GivenName VARCHAR(100) NOT NULL,
    FamilyName VARCHAR(255) NOT NULL,
    CreatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE Carts (
    ID INT PRIMARY KEY AUTO_INCREMENT,
    UserID INT,
    FOREIGN KEY (UserID) REFERENCES Users(ID) ON DELETE CASCADE,  -- For logged-in users
    SessionID VARCHAR(255),                             -- For guest users
    IsActive BOOLEAN DEFAULT TRUE,                      -- Indicates if the cart is active
    ExpiresAt TIMESTAMP DEFAULT (DATE_ADD(NOW(), INTERVAL 7 DAY)),
    CreatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UpdatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

CREATE TABLE CartItems (
    ID INT PRIMARY KEY AUTO_INCREMENT,
    CartID INT NOT NULL,
    ProductID INT NOT NULL,
    ColorID INT NOT NULL,
    SizeID INT NOT NULL,
    FOREIGN KEY (CartID) REFERENCES Carts(ID) ON DELETE CASCADE,   -- Links to Carts table
    FOREIGN KEY (ProductID) REFERENCES Products(ProductID),               -- Links to Products table          -- Number of products in the cart
    FOREIGN KEY (ColorID) REFERENCES Colors(ColorID),
    FOREIGN KEY (SizeID) REFERENCES Sizes(SizeID),
    CreatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UpdatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

